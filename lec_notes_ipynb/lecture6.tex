
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Panel Data}
    \author{Zhentao Shi}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{Panel Data}\label{panel-data}

Economists mostly work with observational data. The data generation
process is out of the researchers' control. If we only have a cross
sectional dataset at hand, it is difficult to control heterogeneity
among the individuals. On the other hand, panel data offers a chance to
control heterogeneity of some particular forms.

A panel dataset tracks the same individuals across time
\(t=1,\ldots,T\). We assume the observations are independent across
\(i=1,\ldots,n\), while we allow some form of dependence within a group
across \(t=1,\ldots,T\) for the same \(i\). We maintain the linear
equation
\[y_{it}=\beta_{1}+x_{it}\beta_{2}+u_{it},\ i=1,\ldots,n;t=1,\ldots,T\label{eq:basic_eq}\]
where \(u_{it}=\alpha_{i}+\epsilon_{it}\) is called the \emph{composite
error}. Note that \(\alpha_{i}\) is the time-invariant unobserved
heterogeneity, while \(\epsilon_{it}\) varies across individuals and
time periods.

\textbf{Data Example} Below is a dataset from
\href{http://www.nber.org/nberces/}{NBER-CES Manufacturing Industry
Database}. The data size is about 4M. Downloading would take up to a few
minutes if the network is slow. Here we have saved the data in a csv
file. The dataset contains annual information of 473 USA industries
during 1958 to 2009. To have some idea what a panel data looks like, we
display a few rows and columns.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} g0 \PY{o}{\PYZlt{}\PYZhy{}} read.csv\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{naics5809.csv\PYZdq{}}\PY{p}{)}
        g0\PY{p}{[}\PY{k+kt}{c}\PY{p}{(}\PY{l+m}{1}\PY{o}{:}\PY{l+m}{10}\PY{p}{,} \PY{l+m}{50}\PY{o}{:}\PY{l+m}{60}\PY{p}{)}\PY{p}{,} \PY{l+m}{1}\PY{o}{:}\PY{l+m}{10}\PY{p}{]}
\end{Verbatim}


    \textbf{Data Example} \texttt{install.packages("plm")} if you use the
package \href{http://cran.r-project.org/web/packages/plm/}{plm} for the
first time. An introduction can be found
\href{http://cran.r-project.org/web/packages/plm/vignettes/plm.pdf}{here}.
Load the package.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k+kn}{library}\PY{p}{(}plm\PY{p}{)}
        g \PY{o}{\PYZlt{}\PYZhy{}} pdata.frame\PY{p}{(} g0\PY{p}{,} index \PY{o}{=} \PY{k+kt}{c}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{naics\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{year\PYZdq{}}\PY{p}{)} \PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} the regression equation}
        equation \PY{o}{\PYZlt{}\PYZhy{}} emp\PY{o}{\PYZti{}}invest\PY{o}{+}cap
        
        \PY{c+c1}{\PYZsh{} Nothing prevents from running an OLS. }
        g.ols \PY{o}{\PYZlt{}\PYZhy{}} lm\PY{p}{(}equation\PY{p}{,} data\PY{o}{=}g\PY{p}{)}
        \PY{k+kp}{summary}\PY{p}{(}g.ols\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} The OLS coefficient estimates are exactly the same as the pooled OLS. }
        \PY{c+c1}{\PYZsh{} The only difference in the summary is that the later shows the panel structure }
        \PY{c+c1}{\PYZsh{} of the data.}
        
        g.pool \PY{o}{\PYZlt{}\PYZhy{}} plm\PY{p}{(}equation\PY{p}{,}data\PY{o}{=}g\PY{p}{,}model\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{pooling\PYZdq{}}\PY{p}{)}
        \PY{k+kp}{summary}\PY{p}{(}g.pool\PY{p}{)}
\end{Verbatim}


    The most important techniques of panel data estimation are the fixed
effect regression and the random effect regression. The asymptotic
distributions of both estimators can be derived from knowledge about the
OLS regression. In this sense, panel data estimation becomes applied
examples of the theory that we have covered in this course. It
highlights the fundamental role of theory in econometrics.

    \subsection{Fixed Effect}\label{fixed-effect}

OLS is consistent for the linear projection model. Since \(\alpha_i\) is
unobservable, it is absorbed into the composite error
\(u_{it} = \alpha_i + \epsilon_{it}\). If
\(\mathrm{cov}\left(\alpha_{i},x_{it}\right)=0\), the OLS is consistent;
otherwise the consistency breaks down. The fixed effect model allows
\(\alpha_{i}\) and \(x_{it}\) to be arbitrarily correlated. The trick to
regain consistency is to eliminate \(\alpha_{i},i=1,\ldots,n\) . The
rest of this section develops the consistency and asymptotic
distribution of the \emph{within estimator}, the default fixed-effect
(FE) estimator. The within estimator transforms the data by subtracting
all the observable variables by the corresponding group means. Averaging
the \(T\) equations of the original regression for the same \(i\), we
have
\[\overline{y}_{i}=\beta_{1}+\overline{x}_{i}\beta_{2}+\bar{u}_{it}=\beta_{1}+\overline{x}_{i}\beta_{2}+\alpha_{i}+\bar{\epsilon}_{it}.\label{eq:group_mean}\]
where \(\overline{y}_{i}=\frac{1}{T}\sum_{t=1}^{T}y_{it}\). Subtracting
the averaged equation from the original equation gives
\[\tilde{y}_{it}=\tilde{x}_{it}\beta_{2}+\tilde{\epsilon}_{it}\label{eq:FE_demean}\]
where \(\tilde{y}_{it}=y_{it}-\overline{y}_{i}\). We then run OLS with
the demeaned data, and obtain the within estimator
\[\widehat{\beta}_{2}^{FE}=\left(\tilde{X}'\tilde{X}\right)^{-1}\tilde{X}'\tilde{y},\]
where \(\tilde{y}=\left(y_{it}\right)_{i,t}\) stacks all the \(nT\)
observations into a vector, and similarly defined is \(\tilde{X}\) as an
\(nT\times K\) matrix, where \(K\) is the dimension of \(\beta_{2}\).

    We know that OLS would be consistent if
\(E\left[\tilde{\epsilon}_{it}|\tilde{x}_{it}\right]=0\). Below we
provide a sufficient condition, which is often called \emph{strict
exogeneity}.

\textbf{Assumption FE.1}
\(E\left[\epsilon_{it}|\alpha_{i},\mathbf{x}_{i}\right]=0\) where
\(\mathbf{x}_{i}=\left(x_{i1},\ldots,x_{iT}\right)\).

Its strictness is relative to the contemporary exogeneity
\(E\left[\epsilon_{it}|\alpha_{i},x_{it}\right]=0\). FE.1 is more
restrictive as it assumes that the error \(\epsilon_{it}\) is mean
independent of the past, present and future explanatory variables.

When we talk about the consistency in panel data, typically we are
considering \(n\to\infty\) while \(T\) stays fixed. This asymptotic
framework is appropriate for panel datasets with many individuals but
only a few time periods.

\textbf{Proposition} If FE.1 is satisfied, then
\(\widehat{\beta}_{2}^{FE}\) is consistent.

    The variance estimation for the FE estimator is a little bit tricky. We
assume a homoskedasitcity condition to simplify the calculation.
Violation of this assumption changes the form of the asymptotic
variance, but does not jeopardize the asymptotic normality.

\textbf{Assumption FE.2}
\(\mathrm{var}\left(\epsilon_{i}|\alpha_{i},\mathbf{x}_{i}\right)=\sigma_{\epsilon}^{2}I_{T}\).

Under FE.1 and FE.2,
\(\widehat{\sigma}_{\epsilon}^{2}=\frac{1}{n\left(T-1\right)}\sum_{i=1}^{n}\sum_{t=1}^{T}\widehat{\tilde{\epsilon}}_{it}^{2}\)
is a consistent estimator of \(\sigma_{\epsilon}^{2}\), where
\(\widehat{\tilde{\epsilon}}=\tilde{y}_{it}-\tilde{x}_{it}\widehat{\beta}_{2}^{FE}\).
Note that the denominator is \(n\left(T-1\right)\), not \(nT\). The
necessity of adjusting the degree of freedom can be easily seen from the
FWL theorem: the FE estimator for the slope coefficient is numerical the
same as its counterpart in the full regression with a dummy variable for
each cross sectional unit.

If FE.1 and FE.2 are satisfied, then
\[\left(\widehat{\sigma}_{\epsilon}^{2}\left(\tilde{X}'\tilde{X}\right)^{-1}\right)^{-1/2}\left(\widehat{\beta}_{2}^{FE}-\beta_{2}^{0}\right)\stackrel{d}{\to} N\left(0,I_{K}\right).\]

We implicitly assume some regularity conditions that allow us to invoke
a law of large numbers and a central limit theorem. We ignore those
technical details here.

It is important to notice that the within-group demean in FE eliminates
all time-invariant explanatory variables, including the intercept.
Therefore from FE we cannot obtain the coefficient estimates of these
time-invariant variables.

\textbf{Data Example} In reality we do not need to compute the estimator
or the variance by hand. \texttt{R} handles them automatically.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} g.fe \PY{o}{\PYZlt{}\PYZhy{}} plm\PY{p}{(}equation\PY{p}{,} data\PY{o}{=}g\PY{p}{,} model\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{within\PYZdq{}}\PY{p}{)} 
        \PY{c+c1}{\PYZsh{} statisticians call the FE estimator \PYZsq{}within\PYZsq{} estimator as it carries out}
        \PY{c+c1}{\PYZsh{} a within\PYZhy{}group transformation}
        \PY{k+kp}{summary}\PY{p}{(}g.fe\PY{p}{)}
\end{Verbatim}


    \textbf{Publication Example} Lin, Justin Yifu (1992):
\href{http://www.jstor.org/stable/2117601}{Rural Reforms and
Agricultural Growth in China}, \emph{The American Economic Review},
Vol.82, No.1, pp.34-51.

The 1978 fundamental Chinese economic reform set off from the rural
sector. The Chinese agricultural industry witnessed a dramatic growth
during 1978-1984. The output was multiple times higher than the average
over of the preceding period. It was in debate whether the growth was
attributed to the household-responsibility system (HRS) reform, or other
factors such as the rising prices and inputs.

Lin (1992) attempts to disentangle these factors using panel data of 28
mainland provinces from 1970 to 1987. He estimates the following
fixed-effect regression model by OLS.

\[
\begin{aligned}
ln Y_{it} & = \alpha_1 + \alpha_2
+ \ln(\mathrm{Land}_{it}) + \alpha_3 \ln (\mathrm{Labor}_{it}) +
\alpha_4 \ln (\mathrm{Capital}_{it}) + \alpha_5 \ln
(\mathrm{Fert}_{it} ) + \alpha_6 \mathrm{HRS}_{it} \\ 
 & +
\alpha_7 \mbox{MP}_{t-1} 
+ \alpha_8 \mathrm{GP}_t + \alpha_9
\mbox{NGCA}_{it} + \alpha_{10} \mbox{MCI}_{it} + \alpha_{11}
T_t + \sum_{j=12}^{39} \alpha_{j} D_j +
\epsilon_{it}.
\end{aligned}\]

Given the OLS estimates, he calculates the serial correlation {[}last
row, Table 5, p.43{]}, which suggests the presence of serial
correlation. He then estimates the regression by GLS and the results are
reported in Table 5 {[}p.43, Column (1) and (3){]}. The empirical
findings are robust across several specifications. For example, Equation
(1â€²) {[}page 42{]} adds time dummies to capture the possible time trend.
The importance of HRS is supported across specifications by the highly
significant coefficient. Based on the estimates, he also evaluates how
much of the relative contribution to the agricultural growth was made by
the reform, and how much was by the change in inputs.

    \subsection{Random Effect}\label{random-effect}

The random effect estimator pursues efficiency at a knife-edge special
case \(\mathrm{cov}\left(\alpha_{i},x_{it}\right)=0\). As mentioned
above, FE is consistent when \(\alpha_{i}\) and \(x_{it}\) are
uncorrelated. However, an inspection of the covariance matrix reveals
that OLS is inefficient.

The starting point is again the original model, while we assume

\textbf{Assumption RE.1}
\(E\left[\epsilon_{it}|\alpha_{i},\mathbf{x}_{i}\right]=0\) and
\(E\left[\alpha_{i}|\mathbf{x}_{i}\right]=0\).

RE.1 obviously implies \(\mathrm{cov}\left(\alpha_{i},x_{it}\right)=0\),
so
\[S=\mathrm{var}\left(u_{i}|\mathbf{x}_{i}\right)=\sigma_{\alpha}^{2}\mathbf{1}_{T}\mathbf{1}_{T}'+\sigma_{\epsilon}^{2}I_{T},\ \mbox{for all }i=1,\ldots,n.\]
Because the covariance matrix is not a scalar multiplication of the
identity matrix, OLS is inefficient.

    As mentioned before, FE estimation kills all time-invariant regressors.
In contrast, RE allows time-invariant explanatory variables. Let us
rewrite the original equation as
\[y_{it}=w_{it}\boldsymbol{\beta}+u_{it},\] where
\(\boldsymbol{\beta}=\left(\beta_{1},\beta_{2}'\right)'\) and
\(w_{it}=\left(1,x_{it}\right)\) are \(K+1\) vectors, i.e.,
\(\boldsymbol{\beta}\) is the parameter including the intercept, and
\(w_{it}\) is the explanatory variables including the constant. Had we
known \(S\), the GLS estimator would be
\[\widehat{\boldsymbol{\beta}}^{RE}=\left(\sum_{i=1}^{n}\mathbf{w}_{i}'S^{-1}\mathbf{w}_{i}\right)^{-1}\sum_{i=1}^{n}\mathbf{w}_{i}'S^{-1}\mathbf{y}_{i}=\left(W'\mathbf{S}^{-1}W\right)^{-1}W'\mathbf{S}^{-1}y\]
where \(\mathbf{S}=I_{T}\otimes S\). (``\(\otimes\)'' denotes the
Kronecker product.) In practice, \(\sigma_{\alpha}^{2}\) and
\(\sigma_{\epsilon}^{2}\) in \(S\) are unknown, so we seek consistent
estimators. Again, we impose a simplifying assumption parallel to FE.2.

    \textbf{Assumption RE.2}
\(\mathrm{var}\left(\epsilon_{i}|\mathbf{x}_{i},\alpha_{i}\right)=\sigma_{\epsilon}^{2}I_{T}\)
and
\(\mathrm{var}\left(\alpha_{i}|\mathbf{x}_{i}\right)=\sigma_{\alpha}^{2}.\)

Under this assumption, we can consistently estimate the variances from
the residuals
\(\widehat{u}_{it}=y_{it}-x_{it}\widehat{\boldsymbol{\beta}}^{RE}\).
That is \[\begin{aligned}
\widehat{\sigma}_{u}^{2} & =  \frac{1}{nT}\sum_{i=1}^{n}\sum_{t=1}^{T}\widehat{u}_{it}^{2}\\
\widehat{\sigma}_{\epsilon}^{2} & =  \frac{1}{n}\sum_{i=1}^{n}\frac{1}{T\left(T-1\right)}\sum_{t=1}^{T}\sum_{r=1}^{T}\sum_{r\neq t}\widehat{u}_{it}\widehat{u}_{ir}.
\end{aligned}\]

Again, we claim the asymptotic normality.

If RE.1 and RE.2 are satisfied, then
\[\left(\widehat{\sigma}_{u}^{2}\left(W'\widehat{\mathbf{S}}^{-1}W\right)^{-1}\right)^{-1/2}\left(\widehat{\boldsymbol{\beta}}^{RE}-\boldsymbol{\beta}_{0}\right)
\stackrel{d}{\to}
N\left(0,I_{K+1}\right)\] where \(\widehat{\mathbf{S}}\) is a consistent
estimator of \(\mathbf{S}\).

The complicated formula of the RE estimator is not important because
again it will be handled by an econometric package automatically. what
is important is the conceptual difference of FE and RE on their
treatment of the unobservable individual heterogeneity.

\textbf{Data Example} RE regression

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} g.re \PY{o}{\PYZlt{}\PYZhy{}} plm\PY{p}{(}equation\PY{p}{,} data\PY{o}{=}g\PY{p}{,} model\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{random\PYZdq{}}\PY{p}{)}
        \PY{k+kp}{summary}\PY{p}{(}g.re\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} Which model is preferred? }
        \PY{c+c1}{\PYZsh{} The Hausman test favors the fixed\PYZhy{}effect model.}
        phtest\PY{p}{(}g.re\PY{p}{,} g.fe\PY{p}{)}
\end{Verbatim}



    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
